WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.codebarrel.addons.automation:manual-trigger-client-resources', location = '/page/viewissue/manual-triggers-support.js' */
define("codebarrel/manual-triggers-support",["jquery","jira/flag","jira/util/events","jira/util/events/types","jira/issue","jira/util/browser",],function($,flag,Events,EventTypes,Issue,Browser){const isIssuePage=function(){return JIRA&&JIRA.Issue&&JIRA.Issue.getStalker&&JIRA.Issue.getStalker().length>0};const showSpinner=function(){const spinContainer=$('<div class="toolbar-group" style="width:16px;height:16px;padding-top: 4px;"/>');const issueOperations=$("#stalker .ops-menus .toolbar-split-left");if(issueOperations.length>0){issueOperations.append(spinContainer);spinContainer.spin()}return spinContainer};const executeManualTrigger=function(url){return $.ajax({url:url,type:"POST",contentType:"application/json",dataType:"json",success:function(){flag.showSuccessMsg("\u81ea\u52a8\u5316","\u5df2\u6210\u529f\u6267\u884c\u81ea\u52a8\u5316\u89c4\u5219\u3002")},error:function(){flag.showErrorMsg("\u81ea\u52a8\u5316","\u6267\u884c\u81ea\u52a8\u5316\u89c4\u5219\u65f6\u51fa\u9519\u3002\u8bf7\u5237\u65b0\u9875\u9762\uff0c\u7136\u540e\u91cd\u8bd5\u3002")}})};return{init:function(){$(document).on("click",".cb-manual-rule-trigger",function(e){e.preventDefault();const spinner=showSpinner();const url=$(this).attr("href");const urlWithoutReturnUrl=url.split("&returnUrl=")[0];executeManualTrigger(urlWithoutReturnUrl).always(function(){spinner.spinStop()}).done(function(){if(isIssuePage()){Events.trigger(EventTypes.REFRESH_ISSUE_PAGE,[Issue.getIssueId()])}else{Browser.reloadViaWindowLocation()}})})}}});
}catch(e){WRMCB(e)};